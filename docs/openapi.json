{"openapi":"3.1.0","info":{"title":"ClinNexus MVP","version":"0.1.0"},"paths":{"/health":{"get":{"summary":"Health","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Health Health Get"}}}}}}},"/api/studies":{"post":{"tags":["studies"],"summary":"Create Study","description":"Создание нового исследования.","operationId":"create_study_api_studies_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StudyCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/StudyOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["studies"],"summary":"List Studies","description":"Список исследований.","operationId":"list_studies_api_studies_get","parameters":[{"name":"workspace_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Workspace Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/StudyOut"},"title":"Response List Studies Api Studies Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/studies/{study_id}":{"get":{"tags":["studies"],"summary":"Get Study","description":"Получение исследования по ID.","operationId":"get_study_api_studies__study_id__get","parameters":[{"name":"study_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Study Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/StudyOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/studies/{study_id}/documents":{"get":{"tags":["studies"],"summary":"List Study Documents","description":"Список документов исследования.","operationId":"list_study_documents_api_studies__study_id__documents_get","parameters":[{"name":"study_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Study Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DocumentOut"},"title":"Response List Study Documents Api Studies  Study Id  Documents Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["documents"],"summary":"Create Document","description":"Создание нового документа.","operationId":"create_document_api_studies__study_id__documents_post","parameters":[{"name":"study_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Study Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/documents/{document_id}/versions":{"get":{"tags":["studies"],"summary":"List Document Versions","description":"Список версий документа.","operationId":"list_document_versions_api_documents__document_id__versions_get","parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Document Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DocumentVersionOut"},"title":"Response List Document Versions Api Documents  Document Id  Versions Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["documents"],"summary":"Create Document Version","description":"Создание новой версии документа.","operationId":"create_document_version_api_documents__document_id__versions_post","parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Document Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentVersionCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentVersionOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/studies/{study_id}/facts":{"get":{"tags":["studies"],"summary":"List Study Facts","description":"Список фактов исследования.","operationId":"list_study_facts_api_studies__study_id__facts_get","parameters":[{"name":"study_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Study Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/FactOut"},"title":"Response List Study Facts Api Studies  Study Id  Facts Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/document-versions/{version_id}/upload":{"post":{"tags":["documents"],"summary":"Upload Document Version","description":"Загрузка файла для версии документа.","operationId":"upload_document_version_api_document_versions__version_id__upload_post","parameters":[{"name":"version_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Version Id"}}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_document_version_api_document_versions__version_id__upload_post"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UploadResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/document-versions/{version_id}/ingest":{"post":{"tags":["documents"],"summary":"Start Ingestion","description":"Запуск ингестии документа.\n\nState machine:\n- uploaded -> processing -> ready/needs_review/failed\n- Можно перезапустить с force=true для failed/needs_review","operationId":"start_ingestion_api_document_versions__version_id__ingest_post","parameters":[{"name":"version_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Version Id"}},{"name":"force","in":"query","required":false,"schema":{"type":"boolean","description":"Принудительный перезапуск для failed/needs_review статусов","default":false,"title":"Force"},"description":"Принудительный перезапуск для failed/needs_review статусов"}],"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Start Ingestion Api Document Versions  Version Id  Ingest Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/document-versions/{version_id}":{"get":{"tags":["documents"],"summary":"Get Document Version","description":"Получение версии документа по ID.","operationId":"get_document_version_api_document_versions__version_id__get","parameters":[{"name":"version_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Version Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentVersionOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/document-versions/{version_id}/anchors":{"get":{"tags":["documents"],"summary":"List Anchors","description":"Список якорей версии документа.","operationId":"list_anchors_api_document_versions__version_id__anchors_get","parameters":[{"name":"version_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Version Id"}},{"name":"section_path","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Section Path"}},{"name":"content_type","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/AnchorContentType"},{"type":"null"}],"title":"Content Type"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AnchorOut"},"title":"Response List Anchors Api Document Versions  Version Id  Anchors Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/document-versions/{version_id}/soa":{"get":{"tags":["documents"],"summary":"Get Soa","description":"Получение Schedule of Activities из версии документа.","operationId":"get_soa_api_document_versions__version_id__soa_get","parameters":[{"name":"version_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Version Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SoAResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/section-contracts":{"get":{"tags":["sections"],"summary":"List Section Contracts","description":"Список контрактов секций.","operationId":"list_section_contracts_api_section_contracts_get","parameters":[{"name":"doc_type","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/DocumentType"},{"type":"null"}],"title":"Doc Type"}},{"name":"is_active","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SectionContractOut"},"title":"Response List Section Contracts Api Section Contracts Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["sections"],"summary":"Create Section Contract","description":"Создание нового контракта секции.","operationId":"create_section_contract_api_section_contracts_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SectionContractCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SectionContractOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/document-versions/{version_id}/section-maps":{"get":{"tags":["sections"],"summary":"List Section Maps","description":"Список маппингов секций для версии документа.","operationId":"list_section_maps_api_document_versions__version_id__section_maps_get","parameters":[{"name":"version_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Version Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SectionMapOut"},"title":"Response List Section Maps Api Document Versions  Version Id  Section Maps Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/document-versions/{version_id}/section-maps/{section_key}/override":{"post":{"tags":["sections"],"summary":"Override Section Map","description":"Переопределение маппинга секции пользователем.","operationId":"override_section_map_api_document_versions__version_id__section_maps__section_key__override_post","parameters":[{"name":"version_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Version Id"}},{"name":"section_key","in":"path","required":true,"schema":{"type":"string","title":"Section Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SectionMapOverrideRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SectionMapOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/document-versions/{version_id}/section-maps/rebuild":{"post":{"tags":["sections"],"summary":"Rebuild Section Maps","description":"Перезапуск маппинга секций для версии документа.","operationId":"rebuild_section_maps_api_document_versions__version_id__section_maps_rebuild_post","parameters":[{"name":"version_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Version Id"}},{"name":"force","in":"query","required":false,"schema":{"type":"boolean","description":"Пересоздать все маппинги (кроме overridden)","default":false,"title":"Force"},"description":"Пересоздать все маппинги (кроме overridden)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Rebuild Section Maps Api Document Versions  Version Id  Section Maps Rebuild Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/document-versions/{version_id}/section-maps/assist":{"post":{"tags":["sections"],"summary":"Assist Section Mapping","description":"LLM-assisted section mapping.\n\nLLM предлагает кандидатов заголовков, затем система прогоняет детерминированный QC Gate.\nЕсли apply=true и QC пройден, обновляет section_maps (не трогает overridden).","operationId":"assist_section_mapping_api_document_versions__version_id__section_maps_assist_post","parameters":[{"name":"version_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Version Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SectionMappingAssistRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SectionMappingAssistResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/generate/section":{"post":{"tags":["generation"],"summary":"Generate Section","description":"Генерация секции документа.","operationId":"generate_section_api_generate_section_post","parameters":[{"name":"X-LLM-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Llm-Api-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GenerateSectionRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GenerateSectionResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/conflicts":{"get":{"tags":["conflicts"],"summary":"List Conflicts","description":"Список конфликтов для исследования.","operationId":"list_conflicts_api_conflicts_get","parameters":[{"name":"study_id","in":"query","required":true,"schema":{"type":"string","format":"uuid","title":"Study Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ConflictOut"},"title":"Response List Conflicts Api Conflicts Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/impact":{"get":{"tags":["impact"],"summary":"List Impact","description":"Список элементов воздействия для исследования.","operationId":"list_impact_api_impact_get","parameters":[{"name":"study_id","in":"query","required":true,"schema":{"type":"string","format":"uuid","title":"Study Id"}},{"name":"change_event_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Change Event Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ImpactItemOut"},"title":"Response List Impact Api Impact Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tasks":{"get":{"tags":["impact"],"summary":"List Tasks","description":"Список задач для исследования.","operationId":"list_tasks_api_tasks_get","parameters":[{"name":"study_id","in":"query","required":true,"schema":{"type":"string","format":"uuid","title":"Study Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskOut"},"title":"Response List Tasks Api Tasks Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"AllowedSourcesMVP":{"properties":{"dependency_sources":{"items":{"$ref":"#/components/schemas/DependencySourceMVP"},"type":"array","title":"Dependency Sources"},"document_scope":{"$ref":"#/components/schemas/DocumentScopeMVP"}},"type":"object","title":"AllowedSourcesMVP","description":"MVP allowed_sources_json."},"AnchorContentType":{"type":"string","enum":["p","cell","fn","hdr","li","tbl"],"title":"AnchorContentType","description":"Тип контента якоря.\n\nanchor_id НЕ зависит от структуры документа; section_path хранится отдельно\nи отражает только текущую структуру данного документа."},"AnchorOut":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"anchor_id":{"type":"string","title":"Anchor Id"},"section_path":{"type":"string","title":"Section Path"},"content_type":{"$ref":"#/components/schemas/AnchorContentType"},"ordinal":{"type":"integer","title":"Ordinal"},"text_raw":{"type":"string","title":"Text Raw"},"location_json":{"additionalProperties":true,"type":"object","title":"Location Json"},"confidence":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Confidence"}},"type":"object","required":["id","anchor_id","section_path","content_type","ordinal","text_raw","location_json","confidence"],"title":"AnchorOut","description":"Схема для вывода якоря."},"ArtifactsSchema":{"properties":{"claims":{"items":{"type":"string"},"type":"array","title":"Claims"},"numbers":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Numbers"},"citations":{"items":{"type":"string"},"type":"array","title":"Citations"},"claim_items":{"items":{"$ref":"#/components/schemas/ClaimArtifact"},"type":"array","title":"Claim Items"},"citation_items":{"items":{"$ref":"#/components/schemas/CitationArtifact"},"type":"array","title":"Citation Items"}},"type":"object","title":"ArtifactsSchema","description":"Схема артефактов генерации."},"Body_upload_document_version_api_document_versions__version_id__upload_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_upload_document_version_api_document_versions__version_id__upload_post"},"CandidateOut":{"properties":{"heading_anchor_id":{"type":"string","title":"Heading Anchor Id"},"confidence":{"type":"number","title":"Confidence"},"rationale":{"type":"string","title":"Rationale"}},"type":"object","required":["heading_anchor_id","confidence","rationale"],"title":"CandidateOut","description":"Кандидат заголовка."},"CitationArtifact":{"properties":{"anchor_id":{"type":"string","title":"Anchor Id"},"role":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Role"},"note":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Note"}},"type":"object","required":["anchor_id"],"title":"CitationArtifact"},"CitationPolicy":{"type":"string","enum":["per_sentence","per_claim","none"],"title":"CitationPolicy"},"ClaimArtifact":{"properties":{"text":{"type":"string","title":"Text"},"anchor_ids":{"items":{"type":"string"},"type":"array","title":"Anchor Ids"},"fact_refs":{"items":{"type":"string"},"type":"array","title":"Fact Refs"},"numbers":{"items":{"$ref":"#/components/schemas/NumberArtifact"},"type":"array","title":"Numbers"}},"type":"object","required":["text"],"title":"ClaimArtifact"},"ConflictOut":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"study_id":{"type":"string","format":"uuid","title":"Study Id"},"conflict_type":{"type":"string","title":"Conflict Type"},"severity":{"$ref":"#/components/schemas/ConflictSeverity"},"status":{"$ref":"#/components/schemas/ConflictStatus"},"title":{"type":"string","title":"Title"},"description":{"type":"string","title":"Description"},"owner_user_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Owner User Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","study_id","conflict_type","severity","status","title","description","owner_user_id","created_at","updated_at"],"title":"ConflictOut","description":"Схема для вывода конфликта."},"ConflictSeverity":{"type":"string","enum":["low","medium","high","critical"],"title":"ConflictSeverity"},"ConflictStatus":{"type":"string","enum":["open","investigating","resolved","accepted_risk","suppressed"],"title":"ConflictStatus"},"ContextBuildMVP":{"properties":{"max_chars":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Max Chars"}},"type":"object","title":"ContextBuildMVP"},"DependencySourceMVP":{"properties":{"doc_type":{"$ref":"#/components/schemas/DocumentType"},"section_keys":{"items":{"type":"string"},"type":"array","title":"Section Keys"},"required":{"type":"boolean","title":"Required","default":true},"role":{"type":"string","title":"Role","default":"primary"},"precedence":{"type":"integer","title":"Precedence","default":0},"min_mapping_confidence":{"type":"number","title":"Min Mapping Confidence","default":0.0},"allowed_content_types":{"items":{"type":"string"},"type":"array","title":"Allowed Content Types"}},"type":"object","required":["doc_type"],"title":"DependencySourceMVP","description":"MVP dependency source для allowed_sources_json."},"DocumentCreate":{"properties":{"doc_type":{"$ref":"#/components/schemas/DocumentType"},"title":{"type":"string","title":"Title"},"lifecycle_status":{"$ref":"#/components/schemas/DocumentLifecycleStatus","default":"draft"}},"type":"object","required":["doc_type","title"],"title":"DocumentCreate","description":"Схема для создания документа."},"DocumentLanguage":{"type":"string","enum":["ru","en","mixed","unknown"],"title":"DocumentLanguage","description":"Язык документа."},"DocumentLifecycleStatus":{"type":"string","enum":["draft","in_review","approved","superseded"],"title":"DocumentLifecycleStatus"},"DocumentOut":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"workspace_id":{"type":"string","format":"uuid","title":"Workspace Id"},"study_id":{"type":"string","format":"uuid","title":"Study Id"},"doc_type":{"$ref":"#/components/schemas/DocumentType"},"title":{"type":"string","title":"Title"},"lifecycle_status":{"$ref":"#/components/schemas/DocumentLifecycleStatus"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","workspace_id","study_id","doc_type","title","lifecycle_status","created_at"],"title":"DocumentOut","description":"Схема для вывода документа."},"DocumentScopeMVP":{"properties":{"same_study_only":{"type":"boolean","title":"Same Study Only","default":true},"allow_superseded":{"type":"boolean","title":"Allow Superseded","default":false}},"type":"object","title":"DocumentScopeMVP"},"DocumentType":{"type":"string","enum":["protocol","sap","tfl","csr","ib","icf","other"],"title":"DocumentType"},"DocumentVersionCreate":{"properties":{"version_label":{"type":"string","title":"Version Label"},"effective_date":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Effective Date"},"document_language":{"$ref":"#/components/schemas/DocumentLanguage","default":"unknown"}},"type":"object","required":["version_label"],"title":"DocumentVersionCreate","description":"Схема для создания версии документа."},"DocumentVersionOut":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"document_id":{"type":"string","format":"uuid","title":"Document Id"},"version_label":{"type":"string","title":"Version Label"},"source_file_uri":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source File Uri"},"source_sha256":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source Sha256"},"effective_date":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Effective Date"},"ingestion_status":{"$ref":"#/components/schemas/IngestionStatus"},"ingestion_summary_json":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Ingestion Summary Json"},"document_language":{"$ref":"#/components/schemas/DocumentLanguage"},"created_by":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Created By"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","document_id","version_label","source_file_uri","source_sha256","effective_date","ingestion_status","ingestion_summary_json","document_language","created_by","created_at"],"title":"DocumentVersionOut","description":"Схема для вывода версии документа."},"EvidenceRole":{"type":"string","enum":["primary","supporting"],"title":"EvidenceRole"},"FactEvidenceOut":{"properties":{"anchor_id":{"type":"string","title":"Anchor Id"},"role":{"$ref":"#/components/schemas/EvidenceRole"}},"type":"object","required":["anchor_id","role"],"title":"FactEvidenceOut","description":"Схема для вывода доказательства факта."},"FactOut":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"fact_type":{"type":"string","title":"Fact Type"},"fact_key":{"type":"string","title":"Fact Key"},"value_json":{"additionalProperties":true,"type":"object","title":"Value Json"},"unit":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Unit"},"status":{"$ref":"#/components/schemas/FactStatus"},"created_from_doc_version_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Created From Doc Version Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"},"evidence":{"items":{"$ref":"#/components/schemas/FactEvidenceOut"},"type":"array","title":"Evidence","default":[]}},"type":"object","required":["id","fact_type","fact_key","value_json","unit","status","created_from_doc_version_id","created_at","updated_at"],"title":"FactOut","description":"Схема для вывода факта."},"FactStatus":{"type":"string","enum":["extracted","validated","conflicting","tbd","needs_review"],"title":"FactStatus"},"FallbackSearchMVP":{"properties":{"query_templates":{"anyOf":[{"additionalProperties":{"items":{"type":"string"},"type":"array"},"type":"object"},{"type":"null"}],"title":"Query Templates"}},"type":"object","title":"FallbackSearchMVP"},"GatePolicyMVP":{"properties":{"on_missing_required_fact":{"type":"string","title":"On Missing Required Fact","default":"blocked"},"on_low_mapping_confidence":{"type":"string","title":"On Low Mapping Confidence","default":"blocked"},"on_citation_missing":{"type":"string","title":"On Citation Missing","default":"fail"}},"type":"object","title":"GatePolicyMVP"},"GenerateSectionRequest":{"properties":{"study_id":{"type":"string","format":"uuid","title":"Study Id"},"target_doc_type":{"$ref":"#/components/schemas/DocumentType"},"section_key":{"type":"string","title":"Section Key"},"template_id":{"type":"string","format":"uuid","title":"Template Id"},"contract_id":{"type":"string","format":"uuid","title":"Contract Id"},"source_doc_version_ids":{"items":{"type":"string","format":"uuid"},"type":"array","title":"Source Doc Version Ids"},"user_instruction":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Instruction"}},"type":"object","required":["study_id","target_doc_type","section_key","template_id","contract_id","source_doc_version_ids"],"title":"GenerateSectionRequest","description":"Запрос на генерацию секции."},"GenerateSectionResult":{"properties":{"content_text":{"type":"string","title":"Content Text"},"artifacts_json":{"$ref":"#/components/schemas/ArtifactsSchema"},"qc_status":{"$ref":"#/components/schemas/QCStatus"},"qc_report_json":{"$ref":"#/components/schemas/QCReportSchema"},"generation_run_id":{"type":"string","format":"uuid","title":"Generation Run Id"}},"type":"object","required":["content_text","artifacts_json","qc_status","qc_report_json","generation_run_id"],"title":"GenerateSectionResult","description":"Результат генерации секции."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ImpactItemOut":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"change_event_id":{"type":"string","format":"uuid","title":"Change Event Id"},"affected_doc_type":{"$ref":"#/components/schemas/DocumentType"},"affected_section_key":{"type":"string","title":"Affected Section Key"},"reason_json":{"additionalProperties":true,"type":"object","title":"Reason Json"},"recommended_action":{"$ref":"#/components/schemas/RecommendedAction"},"status":{"$ref":"#/components/schemas/ImpactStatus"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","change_event_id","affected_doc_type","affected_section_key","reason_json","recommended_action","status","created_at"],"title":"ImpactItemOut","description":"Схема для вывода элемента воздействия."},"ImpactStatus":{"type":"string","enum":["pending","applied","rejected"],"title":"ImpactStatus"},"IngestionStatus":{"type":"string","enum":["uploaded","processing","ready","needs_review","failed"],"title":"IngestionStatus"},"NumberArtifact":{"properties":{"value":{"anyOf":[{"type":"number"},{"type":"integer"}],"title":"Value"},"unit":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Unit"},"fact_key":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Fact Key"}},"type":"object","required":["value"],"title":"NumberArtifact"},"QCErrorSchema":{"properties":{"type":{"type":"string","title":"Type"},"message":{"type":"string","title":"Message"},"anchor_ids":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Anchor Ids"}},"type":"object","required":["type","message"],"title":"QCErrorSchema","description":"Схема ошибки QC."},"QCReportSchema":{"properties":{"status":{"$ref":"#/components/schemas/QCStatus"},"errors":{"items":{"$ref":"#/components/schemas/QCErrorSchema"},"type":"array","title":"Errors","default":[]}},"type":"object","required":["status"],"title":"QCReportSchema","description":"Схема отчёта QC."},"QCRulesetMVP":{"properties":{"phases":{"items":{"type":"string"},"type":"array","title":"Phases"},"gate_policy":{"$ref":"#/components/schemas/GatePolicyMVP"},"warnings":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Warnings"},"numbers_match_facts":{"type":"boolean","title":"Numbers Match Facts","default":false}},"type":"object","title":"QCRulesetMVP","description":"MVP qc_ruleset_json."},"QCStatus":{"type":"string","enum":["pass","fail","blocked"],"title":"QCStatus"},"RecommendedAction":{"type":"string","enum":["auto_patch","regenerate_draft","manual_review"],"title":"RecommendedAction"},"RequiredFactSpecMVP":{"properties":{"fact_key":{"type":"string","title":"Fact Key"},"required":{"type":"boolean","title":"Required","default":true},"min_status":{"type":"string","title":"Min Status","default":"extracted"},"expected_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Expected Type"},"unit_allowed":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Unit Allowed"},"aliases":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Aliases"},"family":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Family"}},"type":"object","required":["fact_key"],"title":"RequiredFactSpecMVP","description":"MVP спецификация одного required fact."},"RequiredFactsMVP":{"properties":{"facts":{"items":{"$ref":"#/components/schemas/RequiredFactSpecMVP"},"type":"array","title":"Facts"}},"type":"object","title":"RequiredFactsMVP","description":"MVP required_facts_json: только список facts[]."},"RetrievalLanguageMVP":{"properties":{"mode":{"type":"string","title":"Mode","default":"auto"}},"type":"object","title":"RetrievalLanguageMVP"},"RetrievalRecipeMVP":{"properties":{"language":{"$ref":"#/components/schemas/RetrievalLanguageMVP"},"context_build":{"$ref":"#/components/schemas/ContextBuildMVP"},"prefer_content_types":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Prefer Content Types"},"fallback_search":{"anyOf":[{"$ref":"#/components/schemas/FallbackSearchMVP"},{"type":"null"}]},"security":{"$ref":"#/components/schemas/SecurityMVP"}},"type":"object","title":"RetrievalRecipeMVP","description":"MVP retrieval_recipe_json (Lean)."},"SectionContractCreate":{"properties":{"workspace_id":{"type":"string","format":"uuid","title":"Workspace Id"},"doc_type":{"$ref":"#/components/schemas/DocumentType"},"section_key":{"type":"string","title":"Section Key"},"title":{"type":"string","title":"Title"},"required_facts_json":{"$ref":"#/components/schemas/RequiredFactsMVP"},"allowed_sources_json":{"$ref":"#/components/schemas/AllowedSourcesMVP"},"retrieval_recipe_json":{"$ref":"#/components/schemas/RetrievalRecipeMVP"},"qc_ruleset_json":{"$ref":"#/components/schemas/QCRulesetMVP"},"citation_policy":{"$ref":"#/components/schemas/CitationPolicy"},"version":{"type":"integer","title":"Version","default":2},"is_active":{"type":"boolean","title":"Is Active","default":true}},"type":"object","required":["workspace_id","doc_type","section_key","title","citation_policy"],"title":"SectionContractCreate","description":"Схема для создания контракта секции."},"SectionContractOut":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"workspace_id":{"type":"string","format":"uuid","title":"Workspace Id"},"doc_type":{"$ref":"#/components/schemas/DocumentType"},"section_key":{"type":"string","title":"Section Key"},"title":{"type":"string","title":"Title"},"required_facts_json":{"additionalProperties":true,"type":"object","title":"Required Facts Json"},"allowed_sources_json":{"additionalProperties":true,"type":"object","title":"Allowed Sources Json"},"retrieval_recipe_json":{"additionalProperties":true,"type":"object","title":"Retrieval Recipe Json"},"qc_ruleset_json":{"additionalProperties":true,"type":"object","title":"Qc Ruleset Json"},"citation_policy":{"$ref":"#/components/schemas/CitationPolicy"},"version":{"type":"integer","title":"Version"},"is_active":{"type":"boolean","title":"Is Active"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","workspace_id","doc_type","section_key","title","required_facts_json","allowed_sources_json","retrieval_recipe_json","qc_ruleset_json","citation_policy","version","is_active","created_at"],"title":"SectionContractOut","description":"Схема для вывода контракта секции."},"SectionMapMappedBy":{"type":"string","enum":["system","user"],"title":"SectionMapMappedBy"},"SectionMapOut":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"doc_version_id":{"type":"string","format":"uuid","title":"Doc Version Id"},"section_key":{"type":"string","title":"Section Key"},"anchor_ids":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Anchor Ids"},"chunk_ids":{"anyOf":[{"items":{"type":"string","format":"uuid"},"type":"array"},{"type":"null"}],"title":"Chunk Ids"},"confidence":{"type":"number","title":"Confidence"},"status":{"$ref":"#/components/schemas/SectionMapStatus"},"mapped_by":{"$ref":"#/components/schemas/SectionMapMappedBy"},"notes":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Notes"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","doc_version_id","section_key","anchor_ids","chunk_ids","confidence","status","mapped_by","notes","created_at"],"title":"SectionMapOut","description":"Схема для вывода маппинга секции."},"SectionMapOverrideRequest":{"properties":{"anchor_ids":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Anchor Ids"},"chunk_ids":{"anyOf":[{"items":{"type":"string","format":"uuid"},"type":"array"},{"type":"null"}],"title":"Chunk Ids"},"notes":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Notes"}},"type":"object","title":"SectionMapOverrideRequest","description":"Схема для переопределения маппинга секции."},"SectionMapStatus":{"type":"string","enum":["mapped","needs_review","overridden"],"title":"SectionMapStatus"},"SectionMappingAssistRequest":{"properties":{"doc_type":{"$ref":"#/components/schemas/DocumentType"},"section_keys":{"items":{"type":"string"},"type":"array","title":"Section Keys"},"max_candidates_per_section":{"type":"integer","title":"Max Candidates Per Section","default":3},"allow_visual_headings":{"type":"boolean","title":"Allow Visual Headings","default":false},"apply":{"type":"boolean","title":"Apply","default":false}},"type":"object","required":["doc_type","section_keys"],"title":"SectionMappingAssistRequest","description":"Схема запроса для LLM-assisted mapping."},"SectionMappingAssistResponse":{"properties":{"version_id":{"type":"string","format":"uuid","title":"Version Id"},"document_language":{"$ref":"#/components/schemas/DocumentLanguage"},"secure_mode":{"type":"boolean","title":"Secure Mode"},"llm_used":{"type":"boolean","title":"Llm Used"},"candidates":{"additionalProperties":{"items":{"$ref":"#/components/schemas/CandidateOut"},"type":"array"},"type":"object","title":"Candidates"},"qc":{"additionalProperties":{"$ref":"#/components/schemas/SectionQCOut"},"type":"object","title":"Qc"}},"type":"object","required":["version_id","document_language","secure_mode","llm_used","candidates","qc"],"title":"SectionMappingAssistResponse","description":"Схема ответа для LLM-assisted mapping."},"SectionQCOut":{"properties":{"status":{"type":"string","title":"Status"},"selected_heading_anchor_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Selected Heading Anchor Id"},"errors":{"items":{"additionalProperties":{"type":"string"},"type":"object"},"type":"array","title":"Errors"}},"type":"object","required":["status","selected_heading_anchor_id","errors"],"title":"SectionQCOut","description":"QC отчёт для секции."},"SecurityMVP":{"properties":{"secure_mode_required":{"type":"boolean","title":"Secure Mode Required","default":true}},"type":"object","title":"SecurityMVP"},"SoAMatrixEntry":{"properties":{"visit_id":{"type":"string","title":"Visit Id"},"proc_id":{"type":"string","title":"Proc Id"},"value":{"type":"string","title":"Value"},"anchor_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Anchor Id"}},"type":"object","required":["visit_id","proc_id","value"],"title":"SoAMatrixEntry","description":"Запись в матрице visits × procedures."},"SoANote":{"properties":{"note_id":{"type":"string","title":"Note Id"},"text":{"type":"string","title":"Text"},"anchor_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Anchor Id"}},"type":"object","required":["note_id","text"],"title":"SoANote","description":"Примечание к Schedule of Activities."},"SoAProcedure":{"properties":{"proc_id":{"type":"string","title":"Proc Id"},"label":{"type":"string","title":"Label"},"category":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Category"},"anchor_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Anchor Id"}},"type":"object","required":["proc_id","label"],"title":"SoAProcedure","description":"Процедура в Schedule of Activities."},"SoAResult":{"properties":{"table_index":{"type":"integer","title":"Table Index"},"section_path":{"type":"string","title":"Section Path"},"visits":{"items":{"$ref":"#/components/schemas/SoAVisit"},"type":"array","title":"Visits"},"procedures":{"items":{"$ref":"#/components/schemas/SoAProcedure"},"type":"array","title":"Procedures"},"matrix":{"items":{"$ref":"#/components/schemas/SoAMatrixEntry"},"type":"array","title":"Matrix"},"notes":{"items":{"$ref":"#/components/schemas/SoANote"},"type":"array","title":"Notes","default":[]},"confidence":{"type":"number","title":"Confidence","default":0.0},"warnings":{"items":{"type":"string"},"type":"array","title":"Warnings","default":[]}},"type":"object","required":["table_index","section_path","visits","procedures","matrix"],"title":"SoAResult","description":"Результат извлечения Schedule of Activities."},"SoAVisit":{"properties":{"visit_id":{"type":"string","title":"Visit Id"},"label":{"type":"string","title":"Label"},"day":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Day"},"anchor_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Anchor Id"}},"type":"object","required":["visit_id","label"],"title":"SoAVisit","description":"Визит в Schedule of Activities."},"StudyCreate":{"properties":{"workspace_id":{"type":"string","format":"uuid","title":"Workspace Id"},"study_code":{"type":"string","title":"Study Code"},"title":{"type":"string","title":"Title"},"status":{"$ref":"#/components/schemas/StudyStatus","default":"active"}},"type":"object","required":["workspace_id","study_code","title"],"title":"StudyCreate","description":"Схема для создания исследования."},"StudyOut":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"workspace_id":{"type":"string","format":"uuid","title":"Workspace Id"},"study_code":{"type":"string","title":"Study Code"},"title":{"type":"string","title":"Title"},"status":{"$ref":"#/components/schemas/StudyStatus"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","workspace_id","study_code","title","status","created_at"],"title":"StudyOut","description":"Схема для вывода исследования."},"StudyStatus":{"type":"string","enum":["active","archived"],"title":"StudyStatus"},"TaskOut":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"study_id":{"type":"string","format":"uuid","title":"Study Id"},"type":{"$ref":"#/components/schemas/TaskType"},"status":{"$ref":"#/components/schemas/TaskStatus"},"assigned_to":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Assigned To"},"payload_json":{"additionalProperties":true,"type":"object","title":"Payload Json"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","study_id","type","status","assigned_to","payload_json","created_at","updated_at"],"title":"TaskOut","description":"Схема для вывода задачи."},"TaskStatus":{"type":"string","enum":["open","in_progress","done","cancelled"],"title":"TaskStatus"},"TaskType":{"type":"string","enum":["review_extraction","resolve_conflict","review_impact","regenerate_section"],"title":"TaskType"},"UploadResult":{"properties":{"version_id":{"type":"string","format":"uuid","title":"Version Id"},"uri":{"type":"string","title":"Uri"},"sha256":{"type":"string","title":"Sha256"},"size":{"type":"integer","title":"Size"},"status":{"type":"string","title":"Status"}},"type":"object","required":["version_id","uri","sha256","size","status"],"title":"UploadResult","description":"Результат загрузки файла."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}