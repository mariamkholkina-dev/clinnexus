### **Концепция ClinNexus MVP: GxP-Compliant Intelligent Document Platform**

#### **Ключевая ценность платформы**

ClinNexus трансформирует процесс работы медицинского райтера, переходя от ручного написания и вычитки к **интеллектуальному управлению контентом**. В рамках MVP (версия 4.1) ценность фокусируется на трех столпах:

1.  **Гарантированная целостность (Integrity & Consistency):** Система обеспечивает "единую версию правды", где Протокол диктует содержимое всех производных документов. Любое изменение в Протоколе автоматически подсвечивает несоответствия в Брошюре, ИС или Отчете.
2.  **Специализированный аудит (GCP/BE Logic):** В отличие от обычных текстовых редакторов, ClinNexus "понимает" логику клинических исследований (Visit Windows, Washout vs T1/2, критерии БЭ) и требования ЕАЭС, выявляя ошибки, которые пропускает глаз человека.
3.  **Ускорение рутины (Automation):** Автоматическая генерация "человекочитаемых" текстов для пациентов (Layman Translation) и конвертация планов в отчеты (Tense Shifting) экономят дни работы райтера.

---

#### **1. Фундаментальные принципы**

**1.1 Протокол как Источник Истины (Protocol as Source of Truth)**
В соответствии с USR-1.6, Протокол является мастер-документом. Все параметры (Fact Store) и нарративы в производных документах (ICF, CSR) являются проекциями данных Протокола. Конфликт всегда решается в пользу Протокола.

**1.2 Цифровой двойник документа (Digital Twin)**
Каждый загруженный документ (DOCX) преобразуется в трехслойную структуру (USR-102):
1.  **Anchors (Якоря):** Неизменяемые ID для каждого абзаца, ячейки таблицы и сноски. Обеспечивают трассируемость (`Hash16`).
2.  **Fact Store (База знаний исследования):** Структурированные данные (дизайн, популяция, фармакокинетика, статистика), извлеченные и валидированные системой.
3.  **Narrative Index:** Векторное представление текста для семантического поиска и стилистических трансформаций.

**1.3 Принцип "Стеклянного ящика" (Traceability)**
Ни одна цифра или утверждение в генерируемом документе не появляется "из ниоткуда". Пользователь всегда может кликнуть на сгенерированный фрагмент и увидеть **Anchor** (ссылку на конкретный абзац Протокола), откуда взята информация.

---

#### **2. Ядро: Единый конвейер обработки (Ingestion)**

При загрузке документов запускается каскад процессов (Ingestion Pipeline):

*   **Семантический парсинг (GCP Structure):** Распознавание специфических разделов по стандартам ЕАЭС (для Протокола, БИ, CSR, ICF).
*   **Fact Extraction & Validation:**
    *   Извлечение параметров (Regex + LLM).
    *   Специфика БЭ: Washout, Sampling points, Analytes.
    *   **UI Validation (USR-103):** Райтер подтверждает ключевые факты перед тем, как система начнет их использовать.
*   **Indexing:** Построение индексов для поиска противоречий.

---

#### **3. Модуль Аудита (The Audit Loop)**

Вместо простой проверки орфографии, система запускает комплексный аудит (USR-3xx, 4xx). Результат — список **Audit Issues** с градацией критичности.

**3.1 Внутридокументный контроль (Internal Consistency)**
*   **Терминологический страж:** Проверяет, что "Препарат А" называется одинаково на странице 5 и 150.
*   **Логический валидатор:**
    *   *Calendar Logic:* Соответствует ли текст описания визитов таблице графика процедур.
    *   *Traceability:* Есть ли для каждой цели (Objective) соответствующая конечная точка (Endpoint) и метод анализа.
*   **БЭ-специфика:** Проверка периода отмывки (Washout) относительно периода полувыведения (T1/2).

**3.2 Междокументный контроль (Cross-Consistency)**
*   Автоматическая сверка: `Протокол <-> Брошюра`, `Протокол <-> ICF`.
*   Выявление **Missing Evidence**: Если в Брошюре есть утверждение о безопасности, которого нет в результатах исследований, система создаст Audit Issue.

---

#### **4. Модуль Генерации и Трансформации (Generation)**

Генерация документов происходит на основе шаблонов и трансформации контента Протокола.

**4.1 Генерация Информированного согласия (ICF)**
*   **Layman Translation (USR-501):** LLM-агент использует Narrative Index для "перевода" медицинских терминов Протокола (напр., "венепункция") на понятный язык ("забор крови из вены"), сохраняя смысловую точность.

**4.2 Генерация Клинического отчета (CSR)**
*   **Auto-population:** Заполнение разделов 1–10 (Введение, Дизайн, Методология) данными из Fact Store Протокола.
*   **Tense Shifting (Future -> Past):** Специализированный трансформер (TenseTransformer) меняет грамматическое время нарратива с планируемого (*"Визиты будут проводиться..."*) на отчетное (*"Визиты проводились..."*).

**4.3 Сборка (Assembly)**
*   **DocxAssembler:** Финальная сборка файла с жестким соблюдением корпоративных стилей и шрифтов (USR-701).

---

#### **5. Управление изменениями (Change Management)**

Система поддерживает жизненный цикл документов (USR-6xx):

1.  **Загрузка новой версии (V2):** Райтер загружает обновленный Протокол.
2.  **Semantic Diff:** Система сравнивает V1 и V2 на уровне текста и фактов (Anchor Aligner).
3.  **Impact Analysis:** Автоматически помечает разделы в ICF и CSR как **Outdated** (Устаревшие), если связанные разделы Протокола изменились.
4.  **Auto-Summary:** Генерация документа "Перечень изменений" (Таблица: Было -> Стало -> Обоснование).

---

#### **6. Соответствие требованиям (Compliance & Performance)**

*   **Роль:** Медицинский райтер (Medical Writer).
*   **Audit Trail:** Неизменяемый лог всех действий (кто загрузил, кто подавил ошибку, кто сгенерировал).
*   **Производительность:** Полный цикл обработки документа (300 стр.) занимает не более 10 минут.
*   **Регуляторная база:** Решения ЕЭК №79 (GCP), №85 (БЭ), №78 (Регистрация).
